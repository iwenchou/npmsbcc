<!DOCTYPE html>
<html>

<head>
    <title>故宮南院觀眾意見回復小幫手</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <style>
        body,
        html,
        .form-control,
        .btn,
        select,
        textarea,
        .progress {
            background-color: #000 !important;
            color: #fff;
        }

        textarea,
        select,
        button,
        input[type="submit"],
        .form-control {
            background-color: #333 !important;
            color: #fff;
            border: 1px solid #555;
        }

        .progress-bar {
            background-color: #808080 !important;
        }

        textarea {
            width: 100%;
            box-sizing: border-box;
        }

        .selected {
            background-color: #555 !important;
        }
    </style>
</head>

<body>
    <h1>故宮南院觀眾意見回復小幫手</h1>
    <form method="POST" action="/generate_response" onsubmit="return generateResponse();">

        <label for="category">請先選擇意見類別：</label>
        <div id="category">
            <button type="button" class="category-btn" data-value="設施">設施</button>
            <button type="button" class="category-btn" data-value="展覽">展覽</button>
            <button type="button" class="category-btn" data-value="服務">服務</button>
        </div>

        <input type="hidden" name="category" id="category-input"><br><br>

        <label for="feedback">請輸入觀眾意見內容：</label><br>
        <textarea name="feedback" id="feedback" rows="4" cols="50"></textarea><br><br>
        <label for="investigation">請輸入業管單位調查結果（可以留空）：</label><br>
        <textarea name="investigation" id="investigation" rows="4" cols="50"></textarea><br><br>

        <label for="word_count">字數:</label>
        <select id="word_count" name="word_count">
            <option value="50">50字以內</option>
            <option value="150">150字以內</option>
            <option value="unlimited" selected>不限（預設）</option>
        </select><br><br>

        <label for="style">風格:</label>
        <select id="style" name="style">
            <option value="general">一般觀眾意見回復</option>
            <option value="social_media">社群媒體使用</option>
        </select><br><br>

        <label for="other">其他:</label>
        <textarea id="other" name="other"></textarea><br><br>

        <!-- Hidden input to store the combined value of word_count, style, and other -->
        <input type="hidden" id="additional_prompt" name="additional_prompt">

        <input type="submit" value="辛苦了！請按我生成回應">
    </form>
    <div class="progress" style="height: 30px;">
        <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
    </div>

    <div id="response-container"></div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // 為每個類別按鈕添加點擊事件
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                // 移除所有按鈕的 selected 類
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
                // 為被點擊的按鈕添加 selected 類
                this.classList.add('selected');
                // 更新隱藏的 input 欄位的值
                document.getElementById('category-input').value = this.getAttribute('data-value');
            });
        });

        function generateResponse() {
            event.preventDefault();

            // Combine the values of word_count, style, and other into the additional_prompt hidden input
            let wordCount = document.getElementById("word_count").value;
            let style = document.getElementById("style").value;
            let other = document.getElementById("other").value;
            document.getElementById("additional_prompt").value = wordCount + ", " + style + ", " + other;

            // ... rest of the function remains unchanged
        }

        // ... rest of the script remains unchanged
    </script>
</body>

</html>
